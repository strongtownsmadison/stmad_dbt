{{
    config(
        tags=['parcels']
    )
}}

select 
    ogc_fid as ogc_fid,
    objectid as obj_id,
    parcel as parcel,
    xrefparcel as x_ref_parcel,
    "address" as parcel_address,
    dateparcelchanged as date_parcel_changed,
    propertyclass as property_class,
    propertyuse as property_use,
    assessmentarea as assessment_area,
    areaname as area_name,
    morethanonebuild as more_than_one_build,
    homestyle as home_style,
    yearbuilt as year_built,
    bedrooms as bedrooms,
    fullbaths as full_baths,
    halfbaths as half_baths,
    totallivingarea as total_living_area,
    firstfloor as first_floor,
    secondfloor as second_floor,
    thirdfloor as third_floor,
    abovethirdfloor as above_third_floor,
    finishedattic as finished_attic,
    basement as basement,
    finishedbasement as finished_basement,
    exteriorwall1 as exterior_wall_1,
    exteriorwall2 as exterior_wall_2,
    fireplaces as fireplaces,
    centralair as central_air,
    partialassessed as partial_assessed,
    assessedbystate as assessed_by_state,
    currentland as current_land,
    currentimpr as current_impr,
    currenttotal as current_total,
    previousland as previous_land,
    previousimpr as previous_impr,
    previoustotal as previous_total,
    nettaxes as net_taxes,
    specialassmnt as special_assmnt,
    othercharges as other_charges,
    totaltaxes as total_taxes,
    lotsize as lot_size,
    zoning1 as zoning_1,
    zoning2 as zoning_2,
    zoning3 as zoning_3,
    zoning4 as zoning_4,
    frontagestreet as frontage_street,
    waterfrontage as water_frontage,
    tifdistrict as tif_district,
    taxschooldist as tax_school_dist,
    attendanceschool as attendance_school,
    elementaryschool as elementary_school,
    middleschool as middle_school,
    highschool as high_school,
    ward as ward,
    stateassemblydistrict as state_assembly_district,
    refusedistrict as refuse_district,
    refuseurl as refuse_url,
    previousland2 as previous_land_2,
    previousimpr2 as previous_impr_2,
    previoustotal2 as previous_total_2,
    alderdistrict as alder_district,
    assessmentchangedate as assessment_change_date,
    blocknumber as block_number,
    buildingdistrict as building_district,
    capitolfiredistrict as capitol_fire_district,
    conditionaluse as conditional_use,
    councilhold as council_hold,
    dateadded as date_added,
    deedpage as deed_page,
    deedrestriction as deed_restriction,
    deedvolume as deed_volume,
    electricaldistrict as electrical_district,
    envhealthdistrict as env_health_district,
    exemptiontype as exemption_type,
    firedistrict as fire_district,
    floodplain as flood_plain,
    fuelstorageproximity as fuel_storage_proximity,
    heatingdistrict as heating_district,
    holds as holds,
    illegallanddivision as illegal_land_division,
    landfillproximity as landfill_proximity,
    landfillremediation as landfill_remediation,
    landmark as landmark,
    landscapebuffer as landscape_buffer,
    localhistoricaldist as local_historical_dist,
    lotdepth as lot_depth,
    lotnumber as lot_number,
    lottype1 as lot_type_1,
    lottype2 as lot_type_2,
    lotwidth as lot_width,
    mcdcode as mcd_code,
    nationalhistoricaldist as national_historical_dist,
    neighborhooddesc as neighborhood_desc,
    neighborhoodprimary as neighborhood_primary,
    neighborhoodsub as neighborhood_sub,
    neighborhoodvuln as neighborhood_vuln,
    noiseairport as noise_airport,
    noiserailroad as noise_railroad,
    noisestreet as noise_street,
    obsoletedate as obsolete_date,
    ownerchangedate as owner_change_date,
    owneroccupied as owner_occupied,
    parcelchangedate as parcel_change_date,
    parcelcode as parcel_code,
    parkproximity as park_proximity,
    pending as pending,
    planningdistrict as planning_district,
    plumbingdistrict as plumbing_district,
    policedistrict as police_district,
    policesector as police_sector,
    previousclass as previous_class,
    propertyusecode as property_use_code,
    railroadfrontage as railroad_frontage,
    reasonchangeimpr as reason_change_impr,
    reasonchangeland as reason_change_land,
    senatedistrict as senate_district,
    supervisordistrict as supervisor_district,
    tifimpr as tif_impr,
    tifland as tif_land,
    tifyear as tif_year,
    totaldwellingunits as total_dwelling_units,
    trafficanalysiszone as traffic_analysis_zone,
    typewaterfrontage as type_water_frontage,
    uwpolice as uw_police,
    wetlandinfo as wetland_info,
    zoningall as zoning_all,
    zoningboardappeal as zoning_board_appeal,
    urbandesigndistrict as urban_design_district,
    housenbr as house_nbr,
    streetdir as street_dir,
    streetname as street_name,
    streettype as street_type,
    unit as unit,
    streetid as street_id,
    stormoutfall as storm_outfall,
    firedemandzone as fire_demand_zone,
    firedemandsubzone as fire_demand_sub_zone,
    propertychangedate as property_change_date,
    maxconstructionyear as max_construction_year,
    xcoord as x_coord,
    ycoord as y_coord,
    shape_length as shape_length,
    shape_area as shape_area,
    geom,
    date_part('year',load_dttm) as parcel_year,
    load_dttm
from {{ source('city_of_madison','parcels_geojson') }}