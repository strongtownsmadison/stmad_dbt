{{
    config(
        tags=["parcels"],
        materialization=view
    )
}}

select 
    "OBJECTID" as obj_id,
    "Parcel" as parcel,
    "XRefParcel" as x_ref_parcel,
    "Address" as parcel_address,
    "DateParcelChanged" as date_parcel_changed,
    "PropertyClass" as property_class,
    "PropertyUse" as property_use,
    "AssessmentArea" as assessment_area,
    "AreaName" as area_name,
    "MoreThanOneBuild" as more_than_one_build,
    "HomeStyle" as home_style,
    "YearBuilt" as year_built,
    "Bedrooms" as bedrooms,
    "FullBaths" as full_baths,
    "HalfBaths" as half_baths,
    "TotalLivingArea" as total_living_area,
    "FirstFloor" as first_floor,
    "SecondFloor" as second_floor,
    "ThirdFloor" as third_floor,
    "AboveThirdFloor" as above_third_floor,
    "FinishedAttic" as finished_attic,
    "Basement" as basement,
    "FinishedBasement" as finished_basement,
    "ExteriorWall1" as exterior_wall_1,
    "ExteriorWall2" as exterior_wall_2,
    "Fireplaces" as fireplaces,
    "CentralAir" as central_air,
    "PartialAssessed" as partial_assessed,
    "AssessedByState" as assessed_by_state,
    "CurrentLand" as current_land,
    "CurrentImpr" as current_impr,
    "CurrentTotal" as current_total,
    "PreviousLand" as previous_land,
    "PreviousImpr" as previous_impr,
    "PreviousTotal" as previous_total,
    "NetTaxes" as net_taxes,
    "SpecialAssmnt" as special_assmnt,
    "OtherCharges" as other_charges,
    "TotalTaxes" as total_taxes,
    "LotSize" as lot_size,
    "Zoning1" as zoning_1,
    "Zoning2" as zoning_2,
    "Zoning3" as zoning_3,
    "Zoning4" as zoning_4,
    "FrontageStreet" as frontage_street,
    "WaterFrontage" as water_frontage,
    "TIFDistrict" as tif_district,
    "TaxSchoolDist" as tax_school_dist,
    "AttendanceSchool" as attendance_school,
    "ElementarySchool" as elementary_school,
    "MiddleSchool" as middle_school,
    "HighSchool" as high_school,
    "Ward" as ward,
    "StateAssemblyDistrict" as state_assembly_district,
    "RefuseDistrict" as refuse_district,
    "RefuseURL" as refuse_url,
    "PreviousLand2" as previous_land_2,
    "PreviousImpr2" as previous_impr_2,
    "PreviousTotal2" as previous_total_2,
    "AlderDistrict" as alder_district,
    "AssessmentChangeDate" as assessment_change_date,
    "BlockNumber" as block_number,
    "BuildingDistrict" as building_district,
    "CapitolFireDistrict" as capitol_fire_district,
    "ConditionalUse" as conditional_use,
    "CouncilHold" as council_hold,
    "DateAdded" as date_added,
    "DeedPage" as deed_page,
    "DeedRestriction" as deed_restriction,
    "DeedVolume" as deed_volume,
    "ElectricalDistrict" as electrical_district,
    "EnvHealthDistrict" as env_health_district,
    "ExemptionType" as exemption_type,
    "FireDistrict" as fire_district,
    "FloodPlain" as flood_plain,
    "FuelStorageProximity" as fuel_storage_proximity,
    "HeatingDistrict" as heating_district,
    "Holds" as holds,
    "IllegalLandDivision" as illegal_land_division,
    "LandfillProximity" as landfill_proximity,
    "LandfillRemediation" as landfill_remediation,
    "Landmark" as landmark,
    "LandscapeBuffer" as landscape_buffer,
    "LocalHistoricalDist" as local_historical_dist,
    "LotDepth" as lot_depth,
    "LotNumber" as lot_number,
    "LotType1" as lot_type_1,
    "LotType2" as lot_type_2,
    "LotWidth" as lot_width,
    "MCDCode" as mcd_code,
    "NationalHistoricalDist" as national_historical_dist,
    "NeighborhoodDesc" as neighborhood_desc,
    "NeighborhoodPrimary" as neighborhood_primary,
    "NeighborhoodSub" as neighborhood_sub,
    "NeighborhoodVuln" as neighborhood_vuln,
    "NoiseAirport" as noise_airport,
    "NoiseRailroad" as noise_railroad,
    "NoiseStreet" as noise_street,
    "ObsoleteDate" as obsolete_date,
    "OwnerChangeDate" as owner_change_date,
    "OwnerOccupied" as owner_occupied,
    "ParcelChangeDate" as parcel_change_date,
    "ParcelCode" as parcel_code,
    "ParkProximity" as park_proximity,
    "Pending" as pending,
    "PlanningDistrict" as planning_district,
    "PlumbingDistrict" as plumbing_district,
    "PoliceDistrict" as police_district,
    "PoliceSector" as police_sector,
    "PreviousClass" as previous_class,
    "PropertyUseCode" as property_use_code,
    "RailroadFrontage" as railroad_frontage,
    "ReasonChangeImpr" as reason_change_impr,
    "ReasonChangeLand" as reason_change_land,
    "SenateDistrict" as senate_district,
    "SupervisorDistrict" as supervisor_district,
    "TifImpr" as tif_impr,
    "TifLand" as tif_land,
    "TifYear" as tif_year,
    "TotalDwellingUnits" as total_dwelling_units,
    "TrafficAnalysisZone" as traffic_analysis_zone,
    "TypeWaterFrontage" as type_water_frontage,
    "UWPolice" as uw_police,
    "WetlandInfo" as wetland_info,
    "ZoningAll" as zoning_all,
    "ZoningBoardAppeal" as zoning_board_appeal,
    "UrbanDesignDistrict" as urban_design_district,
    "HouseNbr" as house_nbr,
    "StreetDir" as street_dir,
    "StreetName" as street_name,
    "StreetType" as street_type,
    "Unit" as unit,
    "StreetID" as street_id,
    "StormOutfall" as storm_outfall,
    "FireDemandZone" as fire_demand_zone,
    "FireDemandSubZone" as fire_demand_sub_zone,
    "PropertyChangeDate" as property_change_date,
    "MaxConstructionYear" as max_construction_year,
    "XCoord" as x_coord,
    "YCoord" as y_coord,
    "SHAPE_Length" as shape_length,
    "SHAPE_Area" as shape_area,
    geom,
    year(load_dttm) as parcel_year,
    load_dttm
from {{ source('city_of_madison','parcels_geojson') }}